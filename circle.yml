machine:
  services:
    - docker
dependencies:
  override:
    - docker info
    - docker build -t pascalgrimaud/postgresql:9.3 .
test:
  override:
    - docker run -d -p 5436:5432 --name=postgresql -e POSTGRES_PASS="pgrimaud" -v ~/volumes/postgresql93/data:/var/lib/postgresql -v ~/volumes/postgresql93/logs:/var/log/postgresql pascalgrimaud/postgresql:9.3 ; sleep 30
    - docker logs postgresql
    - PGPASSWORD=pgrimaud psql -h localhost -p 5436 --username=postgres -c '\conninfo'
    - PGPASSWORD=pgrimaud psql -h 0.0.0.0 -p 5436 --username=postgres -c '\conninfo'
    - PGPASSWORD=pgrimaud psql -h 0.0.0.0 -p 5436 --username=postgres -c 'select version();'
